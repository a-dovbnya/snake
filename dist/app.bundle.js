!function(t){var e={};function s(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,s),o.l=!0,o.exports}s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)s.d(i,o,function(e){return t[e]}.bind(null,o));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=4)}({4:function(t,e,s){"use strict";s.r(e);const i="top",o="bottom",n="left",r="right ",h="PLAY",a="EVENT",c="OVER",d={width:500,height:500,size:20,speed:200,throughWalls:!1,snakeColor:"#a6c529",snakeHeadColor:"#516a05",targetColor:"#aa5d81",sound:!0},l=new Event("updateScore"),p=new Event("gameOver"),u={[h]:new Audio("./assets/sounds/play.mp3"),[a]:new Audio("./assets/sounds/success.mp3"),[c]:new Audio("./assets/sounds/over.mp3")};class g{constructor(t,e={}){t||console.error("ctx is required!"),this.ctx=t,this.options=Object.assign({},d,e),this.cols=Math.floor(this.options.width/this.options.size),this.rows=Math.floor(this.options.height/this.options.size),this.direction=r,this.setNewGame(),this.draw(),document.addEventListener("keydown",this.setDirection.bind(this))}setNewGame(){this.snake=this.createSnake(),this.target=this.createTarget(),this.isNewGame=!1,this.score=0}createSnake(){return[{x:Math.floor(this.cols/2)*this.options.size,y:Math.floor(this.rows/2)*this.options.size}]}createTarget(){return{x:Math.floor(Math.random()*this.cols)*this.options.size,y:Math.floor(Math.random()*this.rows)*this.options.size}}drawBackground(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.cols;e++)this.ctx.fillStyle=e%2==t%2?"rgb(0,0,0,0.05)":"rgb(255,255,255,1)",this.ctx.fillRect(e*this.options.size,t*this.options.size,this.options.size,this.options.size)}drawTarget(){this.ctx.fillStyle=this.options.targetColor,this.drawCircle(this.target.x+this.options.size/2,this.target.y+this.options.size/2)}drawSnake(){for(let t=0;t<this.snake.length;t++)this.ctx.fillStyle=0===t?this.options.snakeHeadColor:this.options.snakeColor,this.drawCircle(this.snake[t].x+this.options.size/2,this.snake[t].y+this.options.size/2)}drawCircle(t,e){this.ctx.beginPath(),this.ctx.arc(t,e,this.options.size/2,0,2*Math.PI,!1),this.ctx.fill()}draw(){this.ctx.clearRect(0,0,this.options.width,this.options.height),this.drawBackground(),this.drawTarget(),this.drawSnake()}updateSnake(){let t=this.snake[0].x,e=this.snake[0].y;switch(this.direction){case n:t-=this.options.size;break;case r:t+=this.options.size;break;case i:e-=this.options.size;break;case o:e+=this.options.size}for(let s=0;s<this.snake.length;s++)if(this.snake[s].x===t&&this.snake[s].y===e)return 1===s?void(this.snake=this.snake.reverse()):void this.end();const s=this.isOutOfZone(t,e);if(s.x!==t||s.y!==e){if(!this.options.throughWalls)return this.end();t=s.x,e=s.y}t===this.target.x&&e===this.target.y?(this.target=this.createTarget(),this.score++,this.soundPlay(a),document.dispatchEvent(l)):this.snake.pop(),this.snake.unshift({x:t,y:e})}isOutOfZone(t,e){return t>=this.options.width?t=0:t<0&&(t=this.options.width-this.options.size),e>=this.options.height?e=0:e<0&&(e=this.options.height-this.options.size),{x:t,y:e}}setDirection(t){return"ArrowUp"===t.code&&this.direction!==o?this.direction=i:"ArrowDown"===t.code&&this.direction!==i?this.direction=o:"ArrowRight"===t.code&&this.direction!==n?this.direction=r:"ArrowLeft"===t.code&&this.direction!==r?this.direction=n:void 0}start(){this.isNewGame&&(this.setNewGame(),document.dispatchEvent(l)),this.stop(),this.timer=setInterval(()=>{this.updateSnake(),this.draw()},this.options.speed),this.soundPlay(h)}stop(){clearInterval(this.timer),this.timer=null}end(){this.stop(),this.isNewGame=!0,this.soundPlay(c),document.dispatchEvent(p)}soundPlay(t){this.options.sound&&u[t]&&u[t].play()}}const f=document;new class{constructor(t){const e=f.getElementById("snake").getContext("2d");this.score=f.getElementById("score"),this.over=f.querySelector(".game-over"),this.snake=new g(e),this.toggleBtn=f.getElementById("start"),this.soundBtn=f.getElementById("sound-btn"),console.log("this.over",this.over),this.setScore(),f.addEventListener("updateScore",this.setScore.bind(this)),f.addEventListener("gameOver",this.showOver.bind(this)),this.toggleBtn.addEventListener("click",this.hideOver.bind(this)),this.soundBtn.addEventListener("click",this.toggleSound.bind(this)),f.getElementById("setting-btn").addEventListener("click",this.showPopup.bind(this)),f.querySelector(".popup__close").addEventListener("click",this.hidePopup.bind(this))}setScore(){console.log("setScoreThis",this),this.score.innerHTML=this.snake.score}showOver(){this.over.classList.add("game-over_active")}hideOver(){console.log("hideOver",this),this.over.classList.remove("game-over_active"),this.snake.start()}showPopup(){f.querySelector(".popup").classList.add("popup__active")}hidePopup(){f.querySelector(".popup").classList.remove("popup__active")}toggleSound(){this.soundBtn.classList.toggle("btn_stroke"),this.snake.options.sound=!this.snake.options.sound,console.log(this.snake.options)}}}});